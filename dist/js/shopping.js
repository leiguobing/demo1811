"use strict";$(function(){var e="";function a(n){var t=(1*$(n).parent().parent().prev().text().slice(2)*(1*$(n).parent().parent().find("i").text())).toFixed(2);$(n).parent().parent().next().find("p").html(t)}$.ajax({type:"get",url:"../api/shopping.php",data:"",success:function(n){var t=JSON.parse(n);e+=t.map(function(n){return' <dl data-id="'+n.id+'">\n                                    <dt class="content_1">\n                                        <span>店铺：</span>\n                                        <span><a href="##">百洋健康官方自营店 </a></span>\n                                        <span>\n                                            <i>免运费</i>\n                                            <p>满88免运费</p>\n                                        </span>\n                                    </dt>\n                                    <dd class="content_2">\n                                        <ul>\n                                            <li class="check">\n                                                <input type="checkbox" id="inp">\n                                            </li>\n                                            <li>\n                                                <img src="'+n.img2+'" alt="">\n                                            </li>\n                                            <li>\n                                                <a href="">'+n.username+'</a>\n                                                <p> \n                                                    <span><img src="../images/list_62.gif" alt=""></span>\n                                                    <span><img src="../images/list_63.gif" alt=""></span>\n                                                </p>\n                                            </li>\n                                            <li>\n                                                <p class="unitPrice">'+n.Presentprice+'</p>\n                                            </li>\n                                            <li>\n                                                <p>\n                                                    <a href="##" class="jian">-</a>\n                                                    <i class="num">'+n.total+'</i>\n                                                    <a href="##" class="jia">+</a>\n                                            </p>\n\n                                        </li>\n                                        <li>\n                                            <p class="total">'+n.Presentprice*n.total+'.00</p>\n                                        </li>\n                                        <li>\n                                            <a href="##">移入收藏夹</a>\n                                            <a href="##" class="delete">删除</a>\n                                        </li>\n                                    </ul>\n                                </dd>\n                            </dl>'}).join(""),$(".content").html(e)}}),$(".content").on("click",".jia",function(){var n=$(this).prev().text();100<++n&&(n=100),$(this).prev().html(n),a(this),p();var t=this.parentElement.parentElement.parentElement.parentElement.parentElement.dataset.id;console.log(t),$.ajax({type:"get",url:"../api/shopping.php",data:{jiannum:n,jiagid:t},success:function(n){}})}),$(".content").on("click",".jian",function(){var n=$(this).next().text();--n<1&&(n=1),$(this).next().html(n),a(this),p();var t=this.parentElement.parentElement.parentElement.parentElement.parentElement.dataset.id;console.log(t),$.ajax({type:"get",url:"../api/shopping.php",data:{jiannum:n,jiangid:t},success:function(n){}})}),$(".content").on("click",".check input",function(){p()});var i=[];function p(){i=[];for(var n=0;n<$(".content input").size();n++)$(".content input").eq(n).prop("checked")&&i.push(n);i.length==$(".content input").size()?$(".mainhead input").prop("checked","checked"):$(".mainhead input").removeAttr("checked");var t=0;for(n=0;n<i.length;n++)t+=1*$(".total").eq(i[n]).text();$(".ttl_1").html(t+".00"),$(".ttl_2").html(t+".00")}$(".mainhead").on("click","input",function(){$(this).prop("checked")?($(".content input").prop("checked","checked"),p()):$(".content input").removeAttr("checked","checked"),p()}),$(".content").on("click",".delete",function(){confirm("您确定要删除当行？")&&$(this).parent().parent().parent().parent().remove();var n=this.parentElement.parentElement.parentElement.parentElement.dataset.id;$.ajax({type:"get",url:"../api/shopping.php",data:{gid:n},success:function(n){}})});var n=window.localStorage,t=n.getItem(n.key(0));console.log(n),$(".number").html(t),$(".tuichu").click(function(){localStorage.clear(n.getItem(n.key(0))),location.href="../index.html"})});